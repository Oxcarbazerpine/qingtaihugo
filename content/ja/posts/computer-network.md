---
title: "コンピュータネットワーク"
date: 2024-06-01
draft: false
tags: ["Network"]
---

## 第1章 コンピュータネットワークのアーキテクチャ
相互に通信できるが、相互に制御しない  
構成要素：ハードウェア、ソフトウェア、プロトコル  
動作方式：  
- エッジ部分：ユーザーが直接利用  
- コア部分：エッジをサポート  
機能：データ通信、リソース共有

### 分類
- 範囲：WAN（広域ネットワーク）、MAN（都市圏ネットワーク）、LAN（ローカルエリアネットワーク）、PAN（パーソナルエリアネットワーク）
- ユーザー：パブリックネットワーク、プライベートネットワーク
- スイッチング技術：回線交換、メッセージ交換、パケット交換
- 伝送技術：ブロードキャスト、ポイントツーポイント

---

## Cisco Packet Tracerシミュレーション
### TCP/IP 4層プロトコルアーキテクチャ
- データリンク層：物理的なデータ伝送とNICによるデータ読み取り
- ネットワーク層：パケットのルーティングと転送を制御
- トランスポート層：コンピュータ間のエンドツーエンド通信を制御
- アプリケーション層：各種アプリケーションのロジック

ハブ：バス型ネットワークの一種で、無差別にブロードキャストし衝突が発生  
概念：IPアドレス、MACアドレス  
ARPプロトコル：Address Resolution Protocol  
ネットワーク層に属し、IPアドレス・MACアドレス・ネットワークインターフェースを記録するARPテーブルを管理。他のプロトコルが宛先MACアドレスを知らない場合、まずARPブロードキャストで問い合わせ、テーブルを更新し、再度元のパケットを送信する。

---

## トップダウンアプローチ
### 概要
ブロードバンド接続：
- DSL（デジタル加入者線）：電話回線の多重化
- ケーブルテレビ回線：光ファイバー＋同軸ケーブル
- FTTH：光ファイバーを家庭まで
- 衛星リンク接続
- WiFi：無線LAN接続 - モデム - ISP
- 広域無線接続：3G

物理メディア：
- ツイストペア：2本のより線、電話線、10M～10G、高速LAN
- 同軸ケーブル：同心円状の2本の銅導体、数十MB
- 光ファイバー：数百GB、電磁干渉なし、長距離減衰なし、高コスト
- 無線チャネル
- 衛星無線：280ms遅延、数百Mbps

パケット交換：
- ルータのストア＆フォワード：パケット全体をキャッシュしてから転送、遅延は2L/R
- キュー遅延：ルータのキャッシュ制限でパケットロス
- 転送テーブル：ポートIPと物理番号

回線交換：リソースを予約し、回線交換構造  
送受信者はまず直接接続する回線を確立し、一定速度でデータを送信  
各回線交換機は通信のために一定帯域を予約
- FDM：周波数分割多重、固定周波数帯
- TDM：時分割多重、各回線に専用タイムスロット

インターネット：ネットワークのネットワーク
1. 第1層ISP - 数十社
2. 地域ISP - 数十万社
3. アクセスISP

遅延：1. 処理遅延 2. キュー遅延 3. 伝送遅延 4. 伝播遅延  
スループット：単位時間あたりのビット数、ボトルネックリンクで決定

---

## 5層プロトコル
1. アプリケーション層：HTTP, SMTP, FTP
2. トランスポート層：TCP, UDP
3. ネットワーク層：IP
4. リンク層：フレーム
5. 物理層

---

## ネットワーク攻撃
- DDoS：分散型サービス拒否攻撃、複数から大量リクエストでサーバ資源を占有
- SSL：Secure Sockets Layer、TCPの暗号化強化、SSLライブラリAPIを利用

プロトコル：信頼性伝送、スループット、タイミング、セキュリティ

---

## アプリケーション層
- HTTP
    - 持続的・非持続的接続（デフォルトは持続的）
    - RTT：TCP接続は2回のRTT＋ファイル転送時間
    - リクエストメッセージ：リクエストライン（メソッド、URL、バージョン）、ヘッダー、エンティティボディ（POST時）
    - レスポンスメッセージ：同様の構造、ステータスコード（301, 400, 505等）、set-cookie、Webキャッシュ、条件付きGET（If-Modified-Since, 304 Not Modified）
- FTP
    - 2本の並列TCP接続：制御（ポート21、アウトオブバンド）、データ（ポート20、転送毎に新規）
    - コマンド：USER, PASS, LIST, RETR, STOR
    - レスポンス：331, 125, 425, 452
- SMTP：TCPベース、持続的接続、PUSHのみ
    - ユーザーエージェント、SMTP、送信サーバ（ポート25）、SMTP、受信サーバ、{POP3, IMAP, HTTP}、受信ユーザーエージェント
    - コマンド：HELO, MAIL FROM, RCPT TO, DATA, QUIT
    - ASCIIのみ、マルチメディアはエンコード必要
- メール取得
    - POP3：ポート110、3フェーズ（認証、トランザクション、更新）、コマンド：user, pass, list, retr, dele, quit
    - IMAP：フォルダ、クエリ対応
    - HTTP
- DNS：Domain Name System、ポート53、UDPベース
    - 分散データベース＋アプリ層プロトコル
    - 機能：ホスト名→正規名変換、負荷分散
    - 階層：ルート、TLD、権威サーバ
    - ローカルDNSサーバ：プロキシとしてリクエスト転送
    - クエリ：再帰・反復
    - DNSキャッシュ、レコード（A, NS, CNAME, MX）、TTL

---

## P2P（ピアツーピア）
- ファイル配布：BitTorrent、トラッカー、レア優先、アンチョークピア、定期最適化
- 分散ハッシュテーブル（DHT）：リソース名のハッシュをキー、ピアIPを値、リング構造、ショートカット、離脱対応

---

## トランスポート層
- ホスト間配送をプロセス間配送（ソケット）に拡張
- 多重化・分離
- UDP：最小限の処理、ポート番号、エラーチェック
- 信頼性通信プロトコル：ストップ＆ウェイト、パイプライン（Go-Back-N, Selective Repeat）
- TCP：3ウェイハンドシェイク、MSS、セグメント構造、累積ACK、タイムアウト/再送、フロー制御（rwnd）、接続確立/終了、SYNフラッド攻撃とSYNクッキー、RSTフラグ、輻輳制御（スロースタート、輻輳回避、ファストリカバリ）、AIMD、公平性

---

## ネットワーク層
- ルータ機能：転送、ルーティング
- IPプロトコル：ベストエフォート
- コネクション型（仮想回線）vs. コネクションレス（データグラム）
- ルータ構造：入出力ポート、スイッチングファブリック（メモリ、バス、クロスバー）、出力バッファ、HOLブロッキング
- IPv4フォーマット、フラグメント、MTU、アドレス（ドット10進、サブネットマスク、CIDR、アドレス集約）、DHCP、NAT、UPnP
- ICMP：ping、traceroute
- IPv6：フォーマット、フローレーベル、ヘッダチェックサムなし、ルータでのフラグメントなし、デュアルスタック、トンネリング、IPsec

---

## ルーティングアルゴリズム
- グローバル（リンクステート）vs. 分散（距離ベクトル）
- ダイクストラ、距離ベクトル、カウントトゥインフィニティ、ポイズンリバース
- 自律システム（AS）、AS内（RIP, OSPF）、AS間（BGP）、AS-PATH、NEXT-HOP、経路選択、ポリシーベースルーティング
- ブロードキャスト・マルチキャストルーティング：フラッディング、スパニングツリー、RPF、プルーニング、DVMRP、PIM、IGMP

---

## リンク層
- サービス：フレーミング、MAC、信頼性配送、エラー検出/訂正（パリティ、チェックサム、CRC）
- 多重アクセス：ポイントツーポイント（PPP, HDLC）、ブロードキャスト（TDM, FDM, CDMA, ランダムアクセス, CSMA/CD, トークンパッシング）
- DOCSIS：ケーブルアクセス、CMTS、FDM/TDM、MAPメッセージ

---

## スイッチドLAN
- リンク層アドレス（MAC）、ARP、イーサネット（フレーム構造、プレアンブル、CRC）、規格（10BASE-T等）、CSMA/CD
- スイッチ：プラグアンドプレイ、スイッチテーブル、自己学習、フィルタリング/転送、エージング、衝突排除、リンク分離、スイッチスニッフィング、ポイズニング
- スイッチvsルータ：第2層vs第3層、プラグアンドプレイ、効率、ブロードキャストストーム、スパニングツリー

---

## VLAN
- ポートとVLANのマッピング、VLAN間通信（ルータ）、トランキング、VLANタグ（TPID、VLAN ID、優先度）

---

## リンク層仮想化
- MPLS：ラベルスイッチング、第2層と第3層の間、ラベルスイッチルータ、トラフィックエンジニアリング、VPN

---

## データセンターネットワーク
- ブレード、ラック、TORスイッチ、ボーダールータ、負荷分散、多層トポロジ、MDC（モジュラーデータセンター）

---

## 無線・モバイルネットワーク
- 概念：基地局、ハンドオフ、インフラ型/アドホック、シングル/マルチホップ
- 無線リンク特性：パスロス、干渉、多重経路、SNR、BER、隠れ端末、フェージング
- CDMA：チッピングレート、エンコード/デコード
- WiFi（802.11）：BSS、AP、SSID、チャネル、アソシエーション、認証、MACプロトコル（CSMA/CA、ACK、RTS/CTS）、フレーム構造、サブネット内移動、レート適応、省電力
- Bluetooth（802.15.1）：WPAN、ピコネット、マスター/スレーブ、FHSS
- ZigBee（802.15.4）：低消費電力、マスター/スレーブ
- セルラー：ライセンスバンド、1G/2G/3G/4G、BTS、FDM/TDM、MSC、GPRS、LTE、OFDM

---

## モビリティ管理
- ホーム/ビジットネットワーク、COA、間接/直接ルーティング、Mobile IP、エージェント広告/要請、登録
- セルラーモビリティ：HLR、GMSC、VLR、コールルーティング、ハンドオフ、無線TCP

---

## マルチメディアネットワーク
- アプリケーション：ビデオ、音声、ストリーミング、VoIP
- ストリーミング：クライアントバッファ、UDP/TCP、DASH、CDN、クラスタ選択
- VoIP：遅延ジッタ、再生戦略、FEC、インターリーブ、エラー隠蔽、中継
- RTP：ヘッダ、タイムスタンプ、SSRC
- SIP：セッション開始、登録

---

## マルチメディア対応ネットワーク
- ベストエフォート、差別化サービス、コネクション単位QoS
- スケジューリング：FIFO、優先度、ラウンドロビン、WFQ
- ポリシング：リーキーバケット、トークンバケット
- Diffserv、QoS、コールアドミッション

---

## ネットワークセキュリティ
- 機密性、完全性、認証、運用セキュリティ、攻撃
- 暗号：共通鍵（シーザー、置換、多表、ストリーム/ブロック暗号、CBC）、公開鍵（RSA）、ハッシュ関数（MD5、SHA-1）、MAC、デジタル署名、公開鍵証明（CA）
- エンドポイント認証：ノンス、リプレイ攻撃防止
- セキュアメール：機密性、認証、完全性、PGP
- SSL/TLS：ハンドシェイク、鍵導出、レコード、切断攻撃
- IPsec/VPN：AH、ESP、SA、トランスポート/トンネルモード、IKE
- 無線LANセキュリティ：WEP、802.11i、EAP、PMK、TK
- ファイアウォール：パケットフィルタ、ステートフル、アプリゲートウェイ、プロキシ、IDS/IPS（シグネチャ/異常ベース）

---

## ネットワーク管理